{"remainingRequest":"C:\\Users\\dell\\Desktop\\Full_Version\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\dell\\Desktop\\Full_Version\\src\\components\\event\\data\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\dell\\Desktop\\Full_Version\\src\\components\\event\\data\\index.vue","mtime":1659970386316},{"path":"C:\\Users\\dell\\Desktop\\Full_Version\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659972864654},{"path":"C:\\Users\\dell\\Desktop\\Full_Version\\node_modules\\babel-loader\\lib\\index.js","mtime":1659972865660},{"path":"C:\\Users\\dell\\Desktop\\Full_Version\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1659972864654},{"path":"C:\\Users\\dell\\Desktop\\Full_Version\\node_modules\\vue-loader\\lib\\index.js","mtime":1659972866064}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0ICQgPSB3aW5kb3cuJAppbXBvcnQgUmVwb3J0IGZyb20gJy4vcmVwb3J0JwppbXBvcnQgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UnCmltcG9ydCB7IHJhbmRvbVN0cmluZyB9IGZyb20gJ0AvdXRpbHMnCmltcG9ydCB7IFJBTkRPTV9DQVJUT09OX0FWQVRBUl9VUkwgfSBmcm9tICdAL2NvbnN0YW50cycKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBldmVudFByb3A6IHsKICAgICAgdHlwZTogT2JqZWN0LAogICAgICBkZWZhdWx0OiB1bmRlZmluZWQsCiAgICB9LAogIH0sCiAgY29tcG9uZW50czogewogICAgUmVwb3J0LAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGV2ZW50OiB1bmRlZmluZWQsCiAgICAgIHN0ZXA6ICdERVRBSUxTJywKICAgICAgZGlzcGxheU5hbWU6IHVuZGVmaW5lZCwKICAgICAgcGhvdG9VUkw6IHVuZGVmaW5lZCwKICAgICAgdXNlcklkOiB1bmRlZmluZWQsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIGlmICh0aGlzLmV2ZW50UHJvcCkgewogICAgICB0aGlzLmV2ZW50ID0gdGhpcy5ldmVudFByb3AKICAgIH0KCiAgICB0aGlzLmRpc3BsYXlOYW1lID0gJ0d1ZXN0XycgKyByYW5kb21TdHJpbmcoNSkKICAgIHRoaXMucGhvdG9VUkwgPQogICAgICBSQU5ET01fQ0FSVE9PTl9BVkFUQVJfVVJMICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKSArICcucG5nJwoKICAgIGNvbnN0IHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXIKICAgIGlmICh1c2VyICYmIHVzZXIuZGlzcGxheU5hbWUpIHsKICAgICAgdGhpcy5kaXNwbGF5TmFtZSA9IHVzZXIuZGlzcGxheU5hbWUKICAgIH0KICAgIGlmICh1c2VyICYmIHVzZXIucGhvdG9VUkwpIHsKICAgICAgdGhpcy5waG90b1VSTCA9IHVzZXIucGhvdG9VUkwKICAgIH0KICAgIGlmICh1c2VyICYmIHVzZXIudWlkKSB7CiAgICAgIHRoaXMudXNlcklkID0gdXNlci51aWQKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGhhbmRsZVNldFN0ZXAoc3RlcCkgewogICAgICB0aGlzLnN0ZXAgPSBzdGVwCiAgICB9LAogICAgaGFuZGxlVG9nZ2xlTW9kYWwoKSB7CiAgICAgICQoJyNldmVudERldGFpbHNNb2RhbCcpLm1vZGFsKCd0b2dnbGUnKQogICAgfSwKICAgIGhhbmRsZUFkZFVwZGF0ZShldmVudCkgewogICAgICB0aGlzLmhhbmRsZVRvZ2dsZU1vZGFsKCkKICAgICAgdGhpcy4kZW1pdCgnYWRkLXRvLWNvbXBhcmFpc29uJywgZXZlbnQpCiAgICB9LAogICAgaGFuZGxlQWRkQ29tbWVudCgkZXZlbnQpIHsKICAgICAgY29uc3QgY29tbWVudCA9IHsKICAgICAgICB0ZXh0OiAkZXZlbnQsCiAgICAgICAgaWQ6IHJhbmRvbVN0cmluZygxNSksCiAgICAgICAgZGlzcGxheU5hbWU6IHRoaXMuZGlzcGxheU5hbWUsCiAgICAgICAgY3JlYXRpb25UaW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICBwaG90b1VSTDogdGhpcy5waG90b1VSTCwKICAgICAgfQogICAgICBpZiAodGhpcy51c2VySWQpIHsKICAgICAgICBjb21tZW50Wyd1c2VySWQnXSA9IHRoaXMudXNlcklkCiAgICAgIH0KICAgICAgY29uc3QgY29tbWVudHMgPSBbLi4udGhpcy5ldmVudC5jb21tZW50cywgY29tbWVudF0KICAgICAgY29uc3QgZmlyZXN0b3JlID0gZmlyZWJhc2UuZmlyZXN0b3JlKCkKICAgICAgY29uc3QgY29sbGVjdGlvbiA9IGZpcmVzdG9yZS5jb2xsZWN0aW9uKCdldmVudHMnKQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGNvbGxlY3Rpb24KICAgICAgICAuZG9jKHRoaXMuZXZlbnQuaWQpCiAgICAgICAgLnVwZGF0ZSh7CiAgICAgICAgICBjb21tZW50cywKICAgICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIGNvbGxlY3Rpb24KICAgICAgICAgICAgLmRvYyh0aGlzLmV2ZW50LmlkKQogICAgICAgICAgICAuZ2V0KCkKICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgdGhpcy5ldmVudCA9IHJlc3BvbnNlLmRhdGEoKQogICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3VwZGF0ZS1ldmVudHMnKQogICAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcikKICAgICAgICAgICAgfSkKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0pCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/event/data","sourcesContent":["<template>\n  <div\n    class=\"modal fade\"\n    id=\"eventDetailsModal\"\n    tabindex=\"-1\"\n    role=\"dialog\"\n    aria-labelledby=\"exampleModalLabel\"\n    aria-hidden=\"true\"\n  >\n    <div class=\"modal-dialog modal-lg\" role=\"document\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <h5\n            :class=\"`modal-title with-pointer ${\n              step === 'COMMENTS' ? 'text-muted' : ''\n            }`\"\n            @click=\"handleSetStep('DETAILS')\"\n          >\n            Details\n          </h5>\n          <button\n            type=\"button\"\n            class=\"close\"\n            data-dismiss=\"modal\"\n            aria-label=\"Close\"\n            @click=\"handleToggleModal\"\n          >\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>\n        <div class=\"modal-body\">\n          <report v-show=\"step === 'DETAILS'\" v-if=\"event\" :event=\"event\" />\n        </div>\n        <div class=\"modal-footer\">\n          <button\n            @click=\"handleToggleModal\"\n            type=\"button\"\n            class=\"btn btn-secondary\"\n            data-dismiss=\"modal\"\n          >\n            Close\n          </button>\n          <button\n            type=\"button\"\n            class=\"btn btn-primary\"\n            @click=\"handleAddUpdate(event)\"\n          >\n            Update\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nconst $ = window.$\nimport Report from './report'\nimport firebase from 'firebase'\nimport { randomString } from '@/utils'\nimport { RANDOM_CARTOON_AVATAR_URL } from '@/constants'\nexport default {\n  props: {\n    eventProp: {\n      type: Object,\n      default: undefined,\n    },\n  },\n  components: {\n    Report,\n  },\n  data() {\n    return {\n      event: undefined,\n      step: 'DETAILS',\n      displayName: undefined,\n      photoURL: undefined,\n      userId: undefined,\n      loading: false,\n    }\n  },\n  mounted() {\n    if (this.eventProp) {\n      this.event = this.eventProp\n    }\n\n    this.displayName = 'Guest_' + randomString(5)\n    this.photoURL =\n      RANDOM_CARTOON_AVATAR_URL + Math.floor(Math.random() * 100) + '.png'\n\n    const user = firebase.auth().currentUser\n    if (user && user.displayName) {\n      this.displayName = user.displayName\n    }\n    if (user && user.photoURL) {\n      this.photoURL = user.photoURL\n    }\n    if (user && user.uid) {\n      this.userId = user.uid\n    }\n  },\n  methods: {\n    handleSetStep(step) {\n      this.step = step\n    },\n    handleToggleModal() {\n      $('#eventDetailsModal').modal('toggle')\n    },\n    handleAddUpdate(event) {\n      this.handleToggleModal()\n      this.$emit('add-to-comparaison', event)\n    },\n    handleAddComment($event) {\n      const comment = {\n        text: $event,\n        id: randomString(15),\n        displayName: this.displayName,\n        creationTime: new Date().getTime(),\n        photoURL: this.photoURL,\n      }\n      if (this.userId) {\n        comment['userId'] = this.userId\n      }\n      const comments = [...this.event.comments, comment]\n      const firestore = firebase.firestore()\n      const collection = firestore.collection('events')\n      this.loading = true\n      collection\n        .doc(this.event.id)\n        .update({\n          comments,\n        })\n        .then(() => {\n          collection\n            .doc(this.event.id)\n            .get()\n            .then((response) => {\n              this.event = response.data()\n              this.$emit('update-events')\n              this.loading = false\n            })\n            .catch((error) => {\n              console.log(error)\n            })\n        })\n        .catch((error) => {\n          console.log(error)\n        })\n    },\n  },\n}\n</script>\n\n<style scoped>\n.with-pointer {\n  cursor: pointer;\n}\n</style>\n"]}]}